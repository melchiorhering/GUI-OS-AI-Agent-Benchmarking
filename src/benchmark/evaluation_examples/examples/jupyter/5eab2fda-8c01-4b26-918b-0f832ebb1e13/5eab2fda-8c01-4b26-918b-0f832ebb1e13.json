{
  "id": "5eab2fda-8c01-4b26-918b-0f832ebb1e13",
  "snapshot": "jupyter",
  "instruction": "Find baby names that appear in all recorded years and sort them in descending order by their total occurrences.\nHere is a step-by-step tutorial from an expert instructing you how to complete it:\nThis task is to find baby names that appear in all recorded years and sort them in descending order by their total occurrences. On the opened VS Code jupyter notebook:\n1. In the VS Code File Explorer on the left, double-click \"result.csv\" to see the target format and \"usa_baby_names.csv\" to preview the data.\n2. Double-click \"notebook.ipynb\" to open the main notebook file.\n3. Scroll to the bottom of the notebook. Hover your mouse below the last cell and click the \"+ Code\" button that appears to add a new, empty cell.\n4. Copy the entire Python and SQL code block below and paste it into the single new cell you just created. This script will create the database table, load the data from the CSV, run the analysis, and save the result.\n```python\n# This assumes 'conn' and 'cursor' objects are created in a previous cell.\n\n# Create the table schema\ncursor.execute(\"\"\"\nCREATE TABLE baby_names (\n  year INT,\n  first_name VARCHAR(64),\n  sex VARCHAR(64),\n  num INT\n);\n\"\"\")\nconn.commit()\n\n# Load data from CSV into the SQL table\ndf = pd.read_csv('usa_baby_names.csv')\ndf.to_sql('baby_names', conn, if_exists='append', index=False)\nconn.commit()\n\n# Build the query to find names present in all 101 years\nquery = \"\"\"\nSELECT first_name, SUM(num) as total_num\nFROM baby_names\nGROUP BY first_name\nHAVING COUNT(DISTINCT year) >= 101\nORDER BY total_num DESC;\n\"\"\"\n\n# Execute the query and save the result\nresult = pd.read_sql_query(query, conn)\nresult.to_csv('result.csv', index=False)\nconn.close()\n\n# Display the resulting DataFrame in the notebook output\nprint(\"Query complete. Data saved to result.csv\")\nresult\n```\n5. After pasting the code, execute the entire notebook to ensure all steps run in order. Click the **\"Run All\"** icon (looks like a double play symbol) in the notebook's top toolbar.\n6. Wait for the execution to complete. The `result.csv` file in the File Explorer will be updated with the names that appear in all recorded years, and the result will also be displayed in the notebook's output.\nYou can follow the detailed GUI plan above using `pyautogui` or proactively tackle the task using Python code",
  "source": [
    "https://www.kaggle.com/code/dillonmyrick/sql-beginner-to-advanced-with-practical-examples/notebook"
  ],
  "related_apps": ["vscode", "jupyter"],
  "tags": ["cli+gui", "traditional_data_processing", "verbose"],
  "action_number": 11,
  "config": [
    {
      "func": "upload_file_to_vm",
      "arguments": {
        "local_path": "usa_baby_names.csv",
        "remote_path": "/home/user/Desktop/usa_baby_names.csv"
      }
    },
    {
      "func": "upload_file_to_vm",
      "arguments": {
        "local_path": "baby_names.db",
        "remote_path": "/home/user/Desktop/baby_names.db"
      }
    },
    {
      "func": "upload_file_to_vm",
      "arguments": {
        "local_path": "notebook.ipynb",
        "remote_path": "/home/user/Desktop/notebook.ipynb"
      }
    },
    {
      "func": "upload_file_to_vm",
      "arguments": {
        "local_path": "result.csv",
        "remote_path": "/home/user/Desktop/result.csv"
      }
    },
    {
      "func": "upload_script_and_execute",
      "arguments": {
        "local_path": "init.sh",
        "remote_path": "/home/user/init.sh"
      }
    }
  ],
  "evaluation": {
    "func": "compare_csv",
    "arguments": {
      "local_expected": "gold.csv",
      "vm_result": "/home/user/Desktop/result.csv",
      "ignore_order": true
    }
  },
  "counterpart": "f650d0be-7222-42ea-9f78-5e59b31b37e3"
}
